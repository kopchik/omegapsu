Version 4
SHEET 1 3536 1300
WIRE 2912 -496 2736 -496
WIRE 3168 -496 2992 -496
WIRE 3168 -384 3168 -496
WIRE 3168 -384 2896 -384
WIRE 2736 -368 2736 -496
WIRE 2832 -368 2736 -368
WIRE 1248 -352 1024 -352
WIRE 1456 -352 1248 -352
WIRE 2960 -352 2896 -352
WIRE 3168 -352 3168 -384
WIRE 3168 -256 3168 -272
WIRE 1248 -144 1248 -352
WIRE 3360 -128 3360 -160
WIRE 3424 -128 3360 -128
WIRE 1024 -96 1024 -352
WIRE 1456 -96 1456 -352
WIRE 2336 -96 2336 -160
WIRE 3360 -96 3360 -128
WIRE 1248 -48 1248 -64
WIRE 1392 -48 1248 -48
WIRE 1024 0 1024 -96
WIRE 1456 16 1456 0
WIRE 1920 16 1456 16
WIRE 2112 16 1984 16
WIRE 2160 16 2112 16
WIRE 2336 16 2336 -16
WIRE 2336 16 2240 16
WIRE 2544 16 2336 16
WIRE 2624 16 2544 16
WIRE 2720 16 2624 16
WIRE 2336 80 2336 16
WIRE 2624 80 2624 16
WIRE -400 160 -544 160
WIRE 2112 160 2112 16
WIRE 2112 160 2016 160
WIRE -400 176 -400 160
WIRE -192 176 -192 144
WIRE -32 176 -192 176
WIRE 1248 176 1248 -48
WIRE 1536 176 1248 176
WIRE 1648 176 1600 176
WIRE 1952 176 1712 176
WIRE -32 192 -32 176
WIRE 2112 192 2016 192
WIRE 2544 208 2544 16
WIRE 2336 224 2336 160
WIRE -192 288 -192 176
WIRE -32 288 -32 272
WIRE 160 304 16 304
WIRE 2464 320 2288 320
WIRE -336 336 -400 256
WIRE 16 384 16 352
WIRE 160 384 16 384
WIRE 1968 384 1904 384
WIRE 2048 384 1968 384
WIRE 2160 384 2128 384
WIRE 1248 400 1248 176
WIRE 1488 400 1248 400
WIRE 1792 400 1552 400
WIRE 1840 400 1792 400
WIRE 2464 400 2464 320
WIRE 2464 400 2400 400
WIRE 2288 416 2288 320
WIRE 2336 416 2288 416
WIRE 2464 432 2400 432
WIRE 2048 464 1904 416
WIRE 2064 464 2048 464
WIRE 2144 464 2288 416
WIRE -192 480 -192 368
WIRE -32 480 -32 368
WIRE -32 480 -192 480
WIRE 2288 528 2288 416
WIRE 2304 528 2288 528
WIRE -192 560 -336 416
WIRE -192 560 -192 480
WIRE 1792 560 1792 400
WIRE 1888 560 1792 560
WIRE 1968 560 1968 384
WIRE 1968 560 1952 560
WIRE 2048 560 2048 464
WIRE 2064 560 2048 560
WIRE 2144 560 2144 464
WIRE 2144 560 2128 560
WIRE 1024 624 1024 80
WIRE 2464 624 2464 432
WIRE 2464 624 1024 624
WIRE 2544 624 2544 288
WIRE 2544 624 2464 624
WIRE 2624 624 2624 144
WIRE 2624 624 2544 624
WIRE 2720 624 2624 624
WIRE 1024 672 1024 624
WIRE -192 688 -192 560
WIRE 1024 800 1024 752
FLAG 2720 16 Vout
IOPIN 2720 16 Out
FLAG 2336 224 Vset
IOPIN 2336 224 Out
FLAG 2160 384 Vset
IOPIN 2160 384 Out
FLAG -192 688 0
FLAG 2336 -160 Iset
IOPIN 2336 -160 Out
FLAG 2112 192 Iset
IOPIN 2112 192 Out
FLAG 1024 800 V-2
FLAG 1024 -96 V+2
FLAG 1872 368 V+2
FLAG 1984 144 V+2
FLAG 1872 432 V-2
FLAG 1984 208 V-2
FLAG 2720 624 0
FLAG 3424 -128 Vout
IOPIN 3424 -128 Out
FLAG 3360 -240 V+
FLAG 3360 -16 V-
FLAG 2864 -400 V+
FLAG 2864 -336 V-
FLAG 2960 -352 Vout
IOPIN 2960 -352 Out
FLAG 2368 384 V+2
FLAG 2368 448 V-2
FLAG 2304 528 virt_gnd
IOPIN 2304 528 Out
FLAG 3168 -256 virt_gnd
IOPIN 3168 -256 Out
SYMBOL voltage -336 320 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 1
SYMBOL res -208 272 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res -416 160 R0
SYMATTR InstName R6
SYMATTR Value 5k
SYMBOL sw -32 384 R180
SYMATTR InstName S1
SYMBOL voltage 160 288 R0
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 -60 56 VBottom 2
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value PULSE(0 1 0 100n 100n 2m 4m)
SYMATTR Value2 AC 0
SYMBOL res -48 176 R0
SYMATTR InstName R9
SYMATTR Value 10
SYMBOL voltage 1024 -16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 12
SYMBOL voltage 2336 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 1
SYMBOL res 2144 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 0.2
SYMBOL Opamps\\AD8675 1872 336 M0
SYMATTR InstName U4
SYMBOL schottky 1920 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1488 416 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D10
SYMATTR Value RB717UM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2528 192 R0
SYMATTR InstName R1
SYMATTR Value 1
SYMBOL npn 1392 -96 R0
SYMATTR InstName Q1
SYMATTR Value 2N4401
SYMBOL current 1248 -144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 1m
SYMBOL res 2048 480 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL cap 1952 544 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL cap 2064 576 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL cap 2608 80 R0
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL res 2144 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL voltage 2336 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 0.02
SYMBOL Opamps\\AD8675 1984 112 M0
SYMATTR InstName U1
SYMBOL schottky 1648 192 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value RB717UM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1536 192 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value RB717UM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 1024 656 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value 12
SYMBOL voltage 3360 -256 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 3360 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL Opamps\\AD8675 2864 -432 M0
SYMATTR InstName U2
SYMBOL res 3152 -368 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL res 3008 -512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL Opamps\\AD8675 2368 352 M0
SYMATTR InstName U3
TEXT -552 888 Left 2 !.tran 0.03
TEXT 1096 880 Left 2 !.model SW SW(Roff=1G Ron=1u Vt=0.1)
