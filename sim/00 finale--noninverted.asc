Version 4
SHEET 1 3672 1084
WIRE 1024 -144 400 -144
WIRE 1120 -144 1024 -144
WIRE 1472 -144 1216 -144
WIRE 1568 -144 1472 -144
WIRE 1728 -144 1648 -144
WIRE 1024 -80 1024 -144
WIRE 1904 -16 1616 -16
WIRE 1472 48 1472 -144
WIRE 1536 48 1472 48
WIRE 1616 48 1616 -16
WIRE 1744 48 1648 48
WIRE 1904 48 1904 -16
WIRE 1904 48 1808 48
WIRE 1024 80 1024 0
WIRE 1168 80 1168 -80
WIRE 1168 80 1024 80
WIRE 3536 128 3536 112
WIRE 1648 144 1648 48
WIRE 1744 144 1712 144
WIRE 1904 144 1904 48
WIRE 1904 144 1824 144
WIRE 2016 176 2016 144
WIRE 2624 176 2624 112
WIRE -880 192 -880 176
WIRE 2464 224 2464 208
WIRE 1840 240 1840 224
WIRE 2352 240 2272 240
WIRE 2432 240 2352 240
WIRE 1904 256 1904 144
WIRE 1904 256 1872 256
WIRE 2528 256 2496 256
WIRE 2576 256 2528 256
WIRE 1168 272 1168 80
WIRE 1296 272 1168 272
WIRE 1648 272 1648 144
WIRE 1648 272 1360 272
WIRE 1808 272 1648 272
WIRE 2272 272 2272 240
WIRE 2432 272 2400 272
WIRE 2016 288 2016 256
WIRE 2016 288 1872 288
WIRE -880 304 -880 272
WIRE -816 304 -880 304
WIRE 2464 304 2464 288
WIRE 1840 320 1840 304
WIRE -880 336 -880 304
WIRE -816 336 -816 304
WIRE 2400 336 2400 272
WIRE 2528 336 2528 320
WIRE 2528 336 2400 336
WIRE 2544 336 2528 336
WIRE 2624 336 2624 272
WIRE 2624 352 2624 336
WIRE 2272 368 2272 352
WIRE 2960 384 2960 272
WIRE -880 432 -880 416
WIRE 1888 432 1712 432
WIRE 1984 448 1952 448
WIRE 2064 448 1984 448
WIRE 2160 448 2144 448
WIRE 2224 448 2160 448
WIRE 3536 448 3536 416
WIRE 1728 464 1712 464
WIRE 1856 464 1808 464
WIRE 1888 464 1856 464
WIRE 2624 480 2624 432
WIRE 2272 496 2272 464
WIRE 1856 560 1856 464
WIRE 1888 560 1856 560
WIRE 1984 560 1984 448
WIRE 1984 560 1952 560
WIRE 1664 592 1664 576
WIRE 2048 608 1696 608
WIRE 2096 608 2048 608
WIRE 2960 608 2960 464
WIRE 1168 624 1168 272
WIRE 1392 624 1168 624
WIRE 1424 624 1392 624
WIRE 1536 624 1488 624
WIRE 1632 624 1536 624
WIRE 2048 624 2048 608
WIRE 1776 640 1696 640
WIRE 1664 672 1664 656
WIRE 1536 720 1536 624
WIRE 1600 720 1536 720
WIRE 1776 720 1776 640
WIRE 1776 720 1664 720
WIRE 2960 720 2960 688
WIRE 2048 736 2048 704
WIRE 3600 768 3552 768
WIRE 3552 784 3552 768
WIRE 1392 800 1392 624
WIRE 1552 800 1392 800
WIRE 1664 800 1616 800
WIRE 1776 800 1776 720
WIRE 1776 800 1744 800
WIRE 1808 800 1776 800
WIRE 1920 800 1888 800
WIRE 3600 800 3600 768
WIRE 3552 896 3552 864
WIRE 3600 896 3600 864
WIRE 3600 896 3552 896
WIRE 3552 928 3552 896
FLAG -816 336 0
FLAG -880 176 +V
FLAG 1664 672 +V
FLAG 400 -144 +V
FLAG 2048 736 0
FLAG 1840 224 +V
FLAG -880 432 -V
FLAG 1664 576 -V
FLAG 1840 320 -V
FLAG 1728 -144 out
IOPIN 1728 -144 Out
FLAG 3552 928 0
FLAG 3536 112 +V
FLAG 3536 448 -V
FLAG 3552 688 out
IOPIN 3552 688 Out
FLAG 1920 800 out
IOPIN 1920 800 Out
FLAG 2016 144 out
IOPIN 2016 144 Out
FLAG 2960 720 0
FLAG 2960 272 out
IOPIN 2960 272 Out
FLAG 2464 304 +V
FLAG 2464 208 -V
FLAG 2624 480 0
FLAG 2624 112 out
IOPIN 2624 112 Out
FLAG 2272 496 0
FLAG 1920 480 -V
FLAG 1920 416 +V
FLAG 2352 320 0
FLAG 1712 464 out
IOPIN 1712 464 Out
FLAG 2096 608 Vset
IOPIN 2096 608 Out
FLAG 1712 432 Vset
IOPIN 1712 432 Out
FLAG 2160 512 0
SYMBOL npn 1120 -80 R270
SYMATTR InstName Q1
SYMATTR Value ZTX1048A
SYMBOL voltage -880 176 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL Misc\\EuropeanResistor 1552 -128 R270
WINDOW 0 27 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value 1R
SYMBOL voltage 2048 608 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 12 0 10m 10m 0 20m 1)
SYMBOL voltage 2016 272 M180
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 1
SYMBOL diode 1424 640 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL current 1024 -80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 108 Left 2
SYMATTR SpiceLine load
SYMATTR InstName I1
SYMATTR Value 3mA
SYMBOL Misc\\EuropeanResistor 3568 768 M0
SYMATTR InstName RL
SYMATTR Value r=if(time>3m&time<7m,1,1k)
SYMBOL voltage -880 320 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL diode 1600 736 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL Misc\\EuropeanResistor 1904 784 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 27 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL Misc\\EuropeanResistor 1520 64 R270
WINDOW 0 27 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL cap 1552 816 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C2
SYMATTR Value 10nF
SYMBOL Misc\\EuropeanResistor 1648 816 R270
WINDOW 0 27 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL cap 1712 160 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C3
SYMATTR Value 500p
SYMBOL Misc\\EuropeanResistor 1840 160 M270
WINDOW 0 27 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL diode 1744 32 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL Opamps\\AD8675 1840 208 M0
SYMATTR InstName U4
SYMBOL Opamps\\AD8675 1664 688 R180
SYMATTR InstName U5
SYMBOL cap 3584 800 R0
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL LED 1296 256 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 72 32 VTop 2
SYMATTR InstName D7
SYMATTR Value NSCW100
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL Opamps\\AD8479 3536 272 R0
SYMATTR InstName U2
SYMBOL voltage 2960 592 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 5
SYMBOL res 2944 368 R0
SYMATTR InstName R1
SYMATTR Value 100
SYMBOL Opamps\\AD8675 2464 320 M180
SYMATTR InstName U1
SYMBOL res 2608 336 R0
SYMATTR InstName R2
SYMATTR Value 0.2
SYMBOL voltage 2272 256 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 0.001
SYMBOL Comparators\\LT1716 1504 448 R0
SYMATTR InstName U3
SYMBOL res 2336 224 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL nmos 2224 368 R0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL res 2160 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL Opamps\\AD8675 1920 384 R0
SYMATTR InstName U6
SYMBOL res 1824 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 2k
SYMBOL cap 1952 544 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 2n
SYMBOL nmos 2576 176 R0
SYMATTR InstName M2
SYMATTR Value AOD4504
SYMBOL cap 2512 256 R0
SYMATTR InstName C5
SYMATTR Value 100p
SYMBOL res 2640 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 2k
SYMBOL cap 2144 448 R0
SYMATTR InstName C6
SYMATTR Value 0.2µ
TEXT -144 992 Left 2 !.tran 10m
TEXT 2192 176 Left 2 ;TODO: hysteresis
