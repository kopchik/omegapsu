Version 4
SHEET 1 3492 1284
WIRE 1456 -352 1024 -352
WIRE 1248 -144 1248 -160
WIRE 1456 -96 1456 -352
WIRE 2336 -96 2336 -160
WIRE 3008 -96 3008 -144
WIRE 1248 -48 1248 -64
WIRE 1392 -48 1248 -48
WIRE 1024 0 1024 -352
WIRE 1456 16 1456 0
WIRE 1920 16 1456 16
WIRE 2112 16 1984 16
WIRE 2160 16 2112 16
WIRE 2336 16 2336 -16
WIRE 2336 16 2240 16
WIRE 2544 16 2336 16
WIRE 2624 16 2544 16
WIRE 2768 16 2624 16
WIRE 2912 16 2848 16
WIRE 3008 16 3008 -16
WIRE 3008 16 2912 16
WIRE 3008 48 3008 16
WIRE 2336 80 2336 16
WIRE 2624 80 2624 16
WIRE 2912 128 2912 16
WIRE 2112 160 2112 16
WIRE 2112 160 2016 160
WIRE 1248 176 1248 -48
WIRE 1536 176 1248 176
WIRE 1648 176 1600 176
WIRE 1952 176 1712 176
WIRE 3008 176 3008 128
WIRE 2112 192 2016 192
WIRE 2544 208 2544 16
WIRE 2336 224 2336 160
WIRE 1968 384 1952 384
WIRE 2048 384 1968 384
WIRE 2160 384 2128 384
WIRE 1248 400 1248 176
WIRE 1632 400 1248 400
WIRE 1792 400 1696 400
WIRE 1888 400 1792 400
WIRE 2032 416 1952 416
WIRE 2112 416 2032 416
WIRE 2032 432 2032 416
WIRE 2112 448 2112 416
WIRE 1792 496 1792 400
WIRE 1888 496 1792 496
WIRE 1968 496 1968 384
WIRE 1968 496 1952 496
WIRE 1024 624 1024 80
WIRE 2032 624 2032 512
WIRE 2032 624 1024 624
WIRE 2112 624 2112 512
WIRE 2112 624 2032 624
WIRE 2544 624 2544 288
WIRE 2544 624 2112 624
WIRE 2624 624 2624 144
WIRE 2624 624 2544 624
WIRE 2720 624 2624 624
WIRE 368 736 224 736
WIRE 368 752 368 736
WIRE 576 752 576 720
WIRE 736 752 576 752
WIRE 736 768 736 752
WIRE 576 864 576 752
WIRE 736 864 736 848
WIRE 928 880 784 880
WIRE 432 912 368 832
WIRE 784 960 784 928
WIRE 928 960 784 960
WIRE 576 1056 576 944
WIRE 736 1056 736 944
WIRE 736 1056 576 1056
WIRE 576 1136 432 992
WIRE 576 1136 576 1056
WIRE 576 1264 576 1136
FLAG 3008 -144 V+
FLAG 3008 176 V-
FLAG 2720 624 Vout
IOPIN 2720 624 Out
FLAG 2912 128 0
FLAG 2336 224 Vset
IOPIN 2336 224 Out
FLAG 1920 368 V+
FLAG 1920 432 V-
FLAG 2160 384 Vset
IOPIN 2160 384 Out
FLAG 1248 -160 V+
FLAG 576 1264 0
FLAG 2336 -160 Iset
IOPIN 2336 -160 Out
FLAG 1984 144 V+
FLAG 1984 208 V-
FLAG 2112 192 Iset
IOPIN 2112 192 Out
SYMBOL voltage 3008 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL voltage 3008 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 20
SYMBOL voltage 432 896 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 1
SYMBOL res 560 848 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 352 736 R0
SYMATTR InstName R6
SYMATTR Value 5k
SYMBOL sw 736 960 R180
SYMATTR InstName S1
SYMBOL voltage 928 864 R0
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 -60 56 VBottom 2
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value PULSE(0 1 0 100n 100n 2m 4m)
SYMATTR Value2 AC 0
SYMBOL res 720 752 R0
SYMATTR InstName R9
SYMATTR Value 10
SYMBOL voltage 1024 -16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 12
SYMBOL voltage 2336 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 1
SYMBOL res 2144 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 0.2
SYMBOL Opamps\\AD8675 1920 336 M0
SYMATTR InstName U4
SYMBOL schottky 1920 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1632 416 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D10
SYMATTR Value RB717UM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2528 192 R0
SYMATTR InstName R1
SYMATTR Value 10
SYMBOL npn 1392 -96 R0
SYMATTR InstName Q1
SYMATTR Value 2N4401
SYMBOL current 1248 -144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 1m
SYMBOL res 2016 416 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL cap 1952 480 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL cap 2128 512 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL cap 2608 80 R0
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL res 2144 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL voltage 2336 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 0.02
SYMBOL Opamps\\AD8675 1984 112 M0
SYMATTR InstName U1
SYMBOL schottky 1648 192 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value RB717UM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1536 192 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value RB717UM
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2864 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1µ
TEXT -552 888 Left 2 !.tran 0.03
TEXT 1096 880 Left 2 !.model SW SW(Roff=1G Ron=1u Vt=0.1)
